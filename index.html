<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบจัดการรายการสินค้า SKU</title>
    <!-- ใช้ Tailwind CSS เพื่อความสวยงามและ responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', 'Kanit', sans-serif;
        }
        .modal-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 40;
        }
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 50;
        }
        .modal-backdrop.active, .modal.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-700">ระบบจัดการรายการสินค้า (SKU)</h1>
            <p class="text-gray-500 mt-2">เพิ่ม แก้ไข และลบรายการสินค้าของคุณ</p>
        </header>

        <main>
            <!-- ส่วนฟอร์มสำหรับเพิ่มและแก้ไขข้อมูล -->
            <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h2 id="form-title" class="text-2xl font-semibold mb-4 text-gray-700">เพิ่มสินค้าใหม่</h2>
                <form id="product-form" class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                    <input type="hidden" id="product-id">
                    <div>
                        <label for="product-sku" class="block text-sm font-medium text-gray-600 mb-1">SKU</label>
                        <input type="text" id="product-sku" placeholder="เช่น TSHIRT-001-BLK" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="product-price" class="block text-sm font-medium text-gray-600 mb-1">ราคา (บาท)</label>
                        <input type="number" id="product-price" placeholder="เช่น 250" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div class="md:col-span-2">
                        <label for="product-details" class="block text-sm font-medium text-gray-600 mb-1">ลิงก์สั่งซื้อ (ถ้ามี)</label>
                        <input type="text" id="product-details" placeholder="เช่น https://www.example.com/product/123" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="flex space-x-2 md:col-span-2">
                         <button type="submit" id="submit-button" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition duration-300 flex items-center justify-center">
                            <i class="fas fa-plus mr-2"></i><span>เพิ่มสินค้า</span>
                        </button>
                        <button type="button" id="cancel-edit-button" class="w-full bg-gray-500 text-white font-bold py-2 px-4 rounded-md hover:bg-gray-600 transition duration-300 hidden items-center justify-center">
                            <i class="fas fa-times mr-2"></i><span>ยกเลิก</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- ส่วนตารางแสดงผล -->
            <div class="bg-white rounded-lg shadow-md overflow-x-auto">
                <table class="w-full table-auto">
                    <thead class="bg-gray-50 border-b-2 border-gray-200">
                        <tr>
                            <th class="p-4 text-left text-sm font-semibold text-gray-600">SKU</th>
                            <th class="p-4 text-left text-sm font-semibold text-gray-600">ลิงก์สั่งซื้อ</th>
                            <th class="p-4 text-left text-sm font-semibold text-gray-600">ราคา</th>
                            <th class="p-4 text-center text-sm font-semibold text-gray-600">การกระทำ</th>
                        </tr>
                    </thead>
                    <tbody id="product-list">
                        <!-- ข้อมูลสินค้าจะถูกเพิ่มที่นี่ด้วย JavaScript -->
                    </tbody>
                </table>
                 <div id="no-products-message" class="text-center p-8 text-gray-500 hidden">
                    <i class="fas fa-box-open fa-3x mb-4"></i>
                    <p>ยังไม่มีสินค้าในรายการ</p>
                    <p class="text-sm">ลองเพิ่มสินค้าใหม่โดยใช้ฟอร์มด้านบน</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal สำหรับยืนยันการลบ -->
    <div id="delete-modal-backdrop" class="modal-backdrop"></div>
    <div id="delete-modal" class="modal bg-white rounded-lg shadow-xl p-6 w-11/12 max-w-sm">
        <h3 class="text-xl font-bold text-gray-800 mb-4">ยืนยันการลบ</h3>
        <p class="text-gray-600 mb-6">คุณแน่ใจหรือไม่ว่าต้องการลบสินค้านี้? การกระทำนี้ไม่สามารถย้อนกลับได้</p>
        <div class="flex justify-end space-x-4">
            <button id="cancel-delete-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">ยกเลิก</button>
            <button id="confirm-delete-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">ยืนยันการลบ</button>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const productForm = document.getElementById('product-form');
            const productList = document.getElementById('product-list');
            const noProductsMessage = document.getElementById('no-products-message');
            const productIdInput = document.getElementById('product-id');
            const productSkuInput = document.getElementById('product-sku');
            const productPriceInput = document.getElementById('product-price');
            const productDetailsInput = document.getElementById('product-details');
            const formTitle = document.getElementById('form-title');
            const submitButton = document.getElementById('submit-button');
            const cancelEditButton = document.getElementById('cancel-edit-button');

            // Modal elements
            const deleteModal = document.getElementById('delete-modal');
            const deleteModalBackdrop = document.getElementById('delete-modal-backdrop');
            const confirmDeleteBtn = document.getElementById('confirm-delete-btn');
            const cancelDeleteBtn = document.getElementById('cancel-delete-btn');
            
            let productToDeleteId = null;

            // ใช้ Local Storage เพื่อเก็บข้อมูลสินค้า
            let products = JSON.parse(localStorage.getItem('products')) || [
                { id: 1, sku: 'TSHIRT-001-BLK', price: 290, details: 'https://www.example.com/tshirt-black' },
                { id: 2, sku: 'JEANS-005-BLU', price: 790, details: 'https://www.example.com/jeans-blue' },
                { id: 3, sku: 'CAP-002-RED', price: 150, details: '' },
            ];
            
            // ฟังก์ชันสำหรับบันทึกข้อมูลลง Local Storage
            const saveProducts = () => {
                localStorage.setItem('products', JSON.stringify(products));
            };

            // ฟังก์ชันสำหรับแสดงผลสินค้าในตาราง
            const renderProducts = () => {
                productList.innerHTML = ''; // เคลียร์ข้อมูลเก่า
                if (products.length === 0) {
                    noProductsMessage.classList.remove('hidden');
                } else {
                    noProductsMessage.classList.add('hidden');
                    products.forEach(product => {
                        const tr = document.createElement('tr');
                        tr.className = 'border-b hover:bg-gray-50';

                        let linkHTML = '-';
                        if (product.details && product.details.trim() !== '') {
                            let url = product.details.trim();
                            // เพิ่ม https:// ถ้ายังไม่มี เพื่อให้ลิงก์ทำงานถูกต้อง
                            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                                url = 'https://' + url;
                            }
                            linkHTML = `<a href="${url}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-blue-600 hover:underline hover:text-blue-800 font-medium py-1 px-2 rounded-md transition-colors duration-200">
                                            <i class="fas fa-external-link-alt mr-2"></i>เปิดลิงก์
                                        </a>`;
                        }

                        tr.innerHTML = `
                            <td class="p-4 text-gray-600">${product.sku}</td>
                            <td class="p-4">${linkHTML}</td>
                            <td class="p-4 text-gray-600">${Number(product.price).toLocaleString('th-TH')}</td>
                            <td class="p-4 text-center">
                                <button data-id="${product.id}" class="edit-btn text-blue-500 hover:text-blue-700 p-2"><i class="fas fa-edit"></i></button>
                                <button data-id="${product.id}" class="delete-btn text-red-500 hover:text-red-700 p-2"><i class="fas fa-trash"></i></button>
                            </td>
                        `;
                        productList.appendChild(tr);
                    });
                }
            };

            // ฟังก์ชันสำหรับรีเซ็ตฟอร์ม
            const resetForm = () => {
                productForm.reset();
                productIdInput.value = '';
                formTitle.textContent = 'เพิ่มสินค้าใหม่';
                submitButton.innerHTML = '<i class="fas fa-plus mr-2"></i><span>เพิ่มสินค้า</span>';
                cancelEditButton.classList.add('hidden');
            };

            // จัดการการ submit ฟอร์ม (ทั้งเพิ่มและแก้ไข)
            productForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const id = productIdInput.value;
                const sku = productSkuInput.value.trim();
                const price = parseFloat(productPriceInput.value);
                const details = productDetailsInput.value.trim();

                if (!sku || isNaN(price) || price < 0) {
                    alert('กรุณากรอกข้อมูลให้ครบถ้วนและถูกต้อง');
                    return;
                }

                if (id) { // ถ้ามี id คือการแก้ไข
                    const index = products.findIndex(p => p.id == id);
                    if (index !== -1) {
                        products[index] = { id: Number(id), sku, price, details };
                    }
                } else { // ถ้าไม่มี id คือการเพิ่มใหม่
                    const newProduct = {
                        id: Date.now(), // สร้าง id ที่ไม่ซ้ำกัน
                        sku,
                        price,
                        details
                    };
                    products.push(newProduct);
                }
                
                saveProducts();
                renderProducts();
                resetForm();
            });
            
            // จัดการการกดปุ่มในตาราง (แก้ไข และ ลบ)
            productList.addEventListener('click', (e) => {
                const target = e.target.closest('button');
                if (!target) return;

                const id = target.dataset.id;
                
                if (target.classList.contains('edit-btn')) {
                    // แก้ไขสินค้า
                    const product = products.find(p => p.id == id);
                    if (product) {
                        productIdInput.value = product.id;
                        productSkuInput.value = product.sku;
                        productPriceInput.value = product.price;
                        productDetailsInput.value = product.details;

                        formTitle.textContent = 'แก้ไขข้อมูลสินค้า';
                        submitButton.innerHTML = '<i class="fas fa-save mr-2"></i><span>บันทึกการแก้ไข</span>';
                        cancelEditButton.classList.remove('hidden');
                        window.scrollTo(0, 0); // เลื่อนขึ้นไปบนสุด
                    }
                } else if (target.classList.contains('delete-btn')) {
                    // ลบสินค้า
                    productToDeleteId = id;
                    deleteModal.classList.add('active');
                    deleteModalBackdrop.classList.add('active');
                }
            });

            // ปุ่มยกเลิกการแก้ไข
            cancelEditButton.addEventListener('click', resetForm);

            // ฟังก์ชันปิด Modal
            const closeDeleteModal = () => {
                deleteModal.classList.remove('active');
                deleteModalBackdrop.classList.remove('active');
                productToDeleteId = null;
            }

            // จัดการการลบเมื่อยืนยัน
            confirmDeleteBtn.addEventListener('click', () => {
                if(productToDeleteId){
                    products = products.filter(p => p.id != productToDeleteId);
                    saveProducts();
                    renderProducts();
                    closeDeleteModal();
                }
            });

            // ปิด Modal เมื่อกดยกเลิก หรือพื้นหลัง
            cancelDeleteBtn.addEventListener('click', closeDeleteModal);
            deleteModalBackdrop.addEventListener('click', closeDeleteModal);
            
            // แสดงผลครั้งแรกเมื่อโหลดหน้า
            renderProducts();
        });
    </script>
</body>
</html>



